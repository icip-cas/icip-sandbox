# [Verl](https://github.com/volcengine/verl) Compatibility

## Data Format
Here is an example of Function Call data.
```json
{
    "prompt": [{"content":"Solve the following coding problem using the programming language python:\n\nYou are provided with array of positive non-zero ints and int n representing n-th power (n >= 2).\n\nFor the given array, calculate the sum of each value to the n-th power. Then subtract the sum of the original array.\n\nExample 1: Input: {1, 2, 3}, 3 --> (1 ^ 3 + 2 ^ 3 + 3 ^ 3 ) - (1 + 2 + 3) --> 36 - 6 --> Output: 30\n\nExample 2: Input: {1, 2}, 5  --> (1 ^ 5 + 2 ^ 5) - (1 + 2) --> 33 - 3 --> Output: 30\n\nWrite your solution by modifying this code:\n\n```python\ndef modified_sum(a, n):\n\t\n```\n\nYour solution should implemented in the function \"modified_sum\". The inputs will be passed to it and it should return the correct solution.\n\n\nNow solve the problem and return the code.","role":"user"}],
    "solutions": ["```python\ndef modified_sum(lst, p):\n\treturn sum((n ** p - n for n in lst))\n\n```"],
    "reward_model": {
        "ground_truth": "{\"input\": [[[1, 2, 3], 3], [[1, 2], 5], [[3, 5, 7], 2], [[1, 2, 3, 4, 5], 3], [[2, 7, 13, 17], 2], [[2, 5, 8], 3], [[2, 4, 6, 8], 6], [[5, 10, 15], 4], [[3, 6, 9, 12], 3]], \"output\": [[30], [30], [68], [210], [472], [630], [312940], [61220], [2670]], \"fn_name\": \"modified_sum\", \"type\": \"function_call\"}",
        "style": "rule"
    },
    "data_source":"taco"
}
```
And an example of Stdin-Stdout:
```json
{
    "prompt": [{"content":"Solve the following coding problem using the programming language python:\n\nAn array is called beautiful if all the elements in the array are equal.\n\nYou can transform an array using the following steps any number of times: \n\n  1. Choose two indices i and j (1 \u2264 i,j \u2264 n), and an integer x (1 \u2264 x \u2264 a_i). Let i be the source index and j be the sink index. \n  2. Decrease the i-th element by x, and increase the j-th element by x. The resulting values at i-th and j-th index are a_i-x and a_j+x respectively. \n  3. The cost of this operation is x \u22c5 |j-i| . \n  4. Now the i-th index can no longer be the sink and the j-th index can no longer be the source. \n\nThe total cost of a transformation is the sum of all the costs in step 3.\n\nFor example, array [0, 2, 3, 3] can be transformed into a beautiful array [2, 2, 2, 2] with total cost 1 \u22c5 |1-3| + 1 \u22c5 |1-4| = 5.\n\nAn array is called balanced, if it can be transformed into a beautiful array, and the cost of such transformation is uniquely defined. In other words, the minimum cost of transformation into a beautiful array equals the maximum cost.\n\nYou are given an array a_1, a_2, \u2026, a_n of length n, consisting of non-negative integers. Your task is to find the number of balanced arrays which are permutations of the given array. Two arrays are considered different, if elements at some position differ. Since the answer can be large, output it modulo 10^9 + 7.\n\nInput\n\nThe first line contains a single integer n (1 \u2264 n \u2264 10^5) \u2014 the size of the array. \n\nThe second line contains n integers a_1, a_2, \u2026, a_n (0 \u2264 a_i \u2264 10^9).\n\nOutput\n\nOutput a single integer \u2014 the number of balanced permutations modulo 10^9+7.\n\nExamples\n\nInput\n\n\n3\n1 2 3\n\n\nOutput\n\n\n6\n\nInput\n\n\n4\n0 4 0 4\n\n\nOutput\n\n\n2\n\nInput\n\n\n5\n0 11 12 13 14\n\n\nOutput\n\n\n120\n\nNote\n\nIn the first example, [1, 2, 3] is a valid permutation as we can consider the index with value 3 as the source and index with value 1 as the sink. Thus, after conversion we get a beautiful array [2, 2, 2], and the total cost would be 2. We can show that this is the only transformation of this array that leads to a beautiful array. Similarly, we can check for other permutations too.\n\nIn the second example, [0, 0, 4, 4] and [4, 4, 0, 0] are balanced permutations.\n\nIn the third example, all permutations are balanced.\n\nThe input will be given via stdin and the output should be printed to stdout by your code.\n\nNow solve the problem by providing the code.","role":"user"}],
    "solutions": ["```python\nn=int(input());a=*map(int,input().split()),;s=sum(a)\nif s%n:print(0);exit(0)\nM=10**9+7;s\/\/=n;f=[1]*(n+1);b=[0]*3;d=dict()\nfor i in range(2,n+1):f[i]=f[i-1]*i%M\nfor x in a:\n\tb[(x>s)-(x<s)]+=1\n\ttry:d[x]+=1\n\texcept:d[x]=1\nk=1\nfor x in d.values():k*=f[x]\nk=f[n]*pow(k,M-2,M)\nprint([k%M,f[b[1]]*f[b[-1]]*2*pow(f[n-b[0]],M-2,M)*k%M][b[1]>1and b[-1]>1])\n```"],
    "reward_model": {
        "ground_truth": "{\"input\": [\"5\\n0 11 12 13 14\\n\", \"3\\n1 2 3\\n\", \"4\\n0 4 0 4\\n\", \"1\\n100000\\n\", \"3\\n0 0 3\\n\", \"1\\n100010\\n\", \"5\\n0 11 1 13 14\\n\", \"5\\n0 12 1 13 14\\n\", \"3\\n0 3 3\\n\", \"3\\n0 1 2\\n\", \"4\\n2 1 0 1\\n\", \"4\\n0 6 0 6\\n\", \"4\\n4 0 0 0\\n\", \"5\\n1 3 0 13 48\\n\", \"5\\n0 1 3 3 13\\n\", \"3\\n0 2 3\\n\", \"4\\n0 6 0 4\\n\", \"1\\n000010\\n\", \"4\\n0 6 1 4\\n\", \"1\\n010010\\n\", \"5\\n0 12 2 13 14\\n\", \"3\\n1 3 3\\n\", \"4\\n-1 6 1 4\\n\", \"1\\n010011\\n\", \"5\\n0 20 2 13 14\\n\", \"3\\n0 3 1\\n\", \"4\\n-1 6 0 4\\n\", \"1\\n010110\\n\", \"5\\n0 20 2 13 11\\n\", \"3\\n0 3 2\\n\", \"4\\n1 6 0 4\\n\", \"1\\n010000\\n\", \"5\\n0 23 2 13 11\\n\", \"4\\n1 1 0 4\\n\", \"1\\n010001\\n\", \"5\\n0 10 2 13 11\\n\", \"3\\n0 1 1\\n\", \"4\\n1 1 0 1\\n\", \"1\\n110000\\n\", \"5\\n1 10 2 13 11\\n\", \"3\\n0 0 1\\n\", \"1\\n110010\\n\", \"5\\n1 10 2 13 13\\n\", \"3\\n0 0 2\\n\", \"4\\n2 2 0 1\\n\", \"1\\n111010\\n\", \"5\\n1 10 2 13 26\\n\", \"4\\n4 2 0 1\\n\", \"1\\n111011\\n\", \"5\\n1 18 2 13 26\\n\", \"4\\n3 2 0 1\\n\", \"1\\n011011\\n\", \"5\\n1 25 2 13 26\\n\", \"4\\n3 1 0 1\\n\", \"1\\n011001\\n\", \"5\\n1 25 2 23 26\\n\", \"4\\n3 0 0 1\\n\", \"1\\n001001\\n\", \"5\\n1 25 2 17 26\\n\", \"4\\n3 0 -1 1\\n\", \"1\\n011101\\n\", \"5\\n2 25 2 17 26\\n\", \"1\\n010101\\n\", \"5\\n2 25 2 17 48\\n\", \"1\\n000101\\n\", \"5\\n0 25 2 17 48\\n\", \"1\\n000111\\n\", \"5\\n0 25 2 34 48\\n\", \"1\\n100111\\n\", \"5\\n0 6 2 34 48\\n\", \"1\\n100011\\n\", \"5\\n0 6 2 17 48\\n\", \"1\\n110111\\n\", \"5\\n0 6 2 17 37\\n\", \"1\\n110011\\n\", \"5\\n0 6 2 17 16\\n\", \"1\\n011111\\n\", \"5\\n0 6 1 17 16\\n\", \"1\\n010111\\n\", \"5\\n0 6 1 27 16\\n\", \"1\\n110101\\n\", \"5\\n0 0 1 27 16\\n\", \"1\\n100101\\n\", \"5\\n0 1 1 27 16\\n\", \"1\\n101101\\n\", \"5\\n0 1 1 5 16\\n\", \"1\\n001101\\n\", \"5\\n0 1 1 5 9\\n\", \"1\\n001111\\n\", \"5\\n0 1 1 5 17\\n\", \"1\\n101111\\n\", \"5\\n0 1 1 4 17\\n\", \"1\\n001110\\n\", \"5\\n-1 1 1 4 17\\n\", \"1\\n001100\\n\", \"5\\n-1 2 1 4 17\\n\", \"1\\n011110\\n\", \"5\\n-2 2 1 4 17\\n\", \"1\\n011010\\n\", \"5\\n-2 2 1 4 3\\n\", \"1\\n000110\\n\", \"5\\n-2 2 1 2 3\\n\", \"1\\n000001\\n\", \"5\\n-2 2 2 2 3\\n\", \"1\\n000000\\n\", \"1\\n100001\\n\", \"1\\n110001\\n\", \"1\\n101110\\n\", \"1\\n111101\\n\", \"1\\n111001\\n\", \"1\\n111111\\n\", \"1\\n001011\\n\", \"1\\n001000\\n\", \"1\\n001010\\n\", \"1\\n000100\\n\", \"1\\n010100\\n\", \"1\\n011100\\n\", \"1\\n100100\\n\", \"1\\n101010\\n\", \"1\\n101000\\n\", \"1\\n111000\\n\", \"1\\n101100\\n\", \"1\\n111100\\n\", \"1\\n110100\\n\", \"1\\n101001\\n\", \"1\\n111110\\n\", \"1\\n101011\\n\", \"1\\n011000\\n\", \"1\\n000011\\n\", \"1\\n100110\\n\", \"1\\n110110\\n\", \"3\\n1 0 3\\n\", \"5\\n0 11 14 13 14\\n\", \"3\\n1 4 3\\n\", \"4\\n0 4 0 6\\n\", \"5\\n0 11 1 25 14\\n\", \"3\\n0 2 4\\n\", \"4\\n0 2 1 4\\n\", \"5\\n0 0 1 13 14\\n\", \"3\\n1 3 4\\n\", \"4\\n0 9 1 4\\n\", \"5\\n0 12 2 5 14\\n\", \"3\\n2 3 3\\n\", \"4\\n-1 6 1 1\\n\", \"5\\n-1 20 2 13 14\\n\", \"3\\n0 2 1\\n\", \"4\\n-1 7 0 4\\n\", \"5\\n0 33 2 13 11\\n\", \"3\\n0 3 0\\n\", \"4\\n1 12 0 4\\n\", \"5\\n0 4 2 13 11\\n\", \"3\\n0 2 2\\n\", \"4\\n1 0 0 4\\n\", \"5\\n0 10 2 17 11\\n\", \"3\\n0 1 3\\n\", \"4\\n0 1 0 1\\n\", \"5\\n1 10 2 13 15\\n\", \"4\\n1 2 0 1\\n\", \"5\\n1 3 2 13 13\\n\", \"3\\n-1 0 2\\n\", \"4\\n2 2 0 2\\n\", \"5\\n1 3 2 13 26\\n\", \"4\\n4 2 -1 1\\n\", \"5\\n2 18 2 13 26\\n\", \"4\\n3 2 -1 1\\n\", \"5\\n1 33 2 13 26\\n\", \"4\\n1 1 0 0\\n\", \"5\\n1 25 2 23 38\\n\", \"4\\n6 0 0 1\\n\", \"5\\n1 0 2 17 26\\n\", \"4\\n3 0 0 2\\n\", \"5\\n2 25 4 17 26\\n\", \"5\\n2 25 2 17 71\\n\", \"5\\n0 25 2 17 70\\n\", \"5\\n1 25 2 34 48\\n\", \"5\\n0 6 2 17 8\\n\", \"5\\n0 2 2 17 37\\n\", \"5\\n0 11 2 17 16\\n\", \"5\\n0 0 1 17 16\\n\", \"5\\n0 6 1 41 16\\n\", \"5\\n0 0 0 27 16\\n\", \"5\\n0 1 1 12 16\\n\", \"5\\n0 1 1 5 22\\n\", \"5\\n0 1 0 5 9\\n\", \"5\\n0 1 0 5 17\\n\", \"5\\n0 1 1 3 17\\n\", \"5\\n-1 1 1 3 17\\n\", \"5\\n-4 2 1 4 3\\n\", \"5\\n-2 2 1 2 0\\n\", \"5\\n-2 2 2 3 3\\n\", \"3\\n1 1 3\\n\", \"5\\n0 11 14 13 5\\n\", \"3\\n0 4 3\\n\", \"5\\n0 11 1 25 13\\n\", \"3\\n0 1 4\\n\", \"4\\n1 2 1 4\\n\", \"5\\n0 0 1 13 22\\n\", \"3\\n2 3 4\\n\", \"4\\n0 9 0 4\\n\", \"5\\n0 12 2 5 10\\n\", \"3\\n2 3 2\\n\", \"4\\n-1 6 1 0\\n\", \"5\\n-1 9 2 13 14\\n\", \"3\\n0 0 0\\n\", \"4\\n-1 4 0 4\\n\"], \"output\": [\"\\n120\", \"\\n6\", \"\\n2\", \"1\", \"3\", \"1\\n\", \"0\\n\", \"24\\n\", \"3\\n\", \"6\\n\", \"12\\n\", \"2\\n\", \"4\\n\", \"120\\n\", \"60\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"24\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"12\\n\", \"1\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"24\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"24\\n\", \"1\\n\", \"24\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"12\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"0\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"1\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"6\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"6\\n\", \"0\\n\", \"0\\n\", \"3\\n\", \"0\\n\", \"24\\n\", \"0\\n\", \"0\\n\", \"24\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"12\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"24\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"24\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"24\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"12\\n\", \"0\\n\", \"12\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"24\\n\", \"0\\n\", \"12\\n\", \"0\\n\", \"6\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"0\\n\", \"1\\n\", \"0\\n\"], \"fn_name\": null, \"type\": \"stdin_stdout\"}",
        "style": "rule"
    },
    "data_source": "code_contests"
}
```

## Verl Reward Score
Modify [verl/utils/reward_score/sandbox_fusion](https://github.com/MrZhengXin/verl_sandbox/tree/main/verl/utils/reward_score/sandbox_fusion) and [verl/workers/reward_manager/prime.py](https://github.com/MrZhengXin/verl_sandbox/blob/main/verl/workers/reward_manager/prime.py) to support the sandbox `common_evaluate_batch` API.

## Verl Training Arguments
Similarly to the verl official sandbox usage example, add the following arguments to the training script:
```bash
    reward_model.sandbox_fusion.url='http://0.0.0.0:8080/common_evaluate_batch' \
    reward_model.sandbox_fusion.max_concurrent=64 \
```